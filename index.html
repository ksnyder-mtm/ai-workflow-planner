<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMPAS Method Planner - Meet the Moment</title>
    <link rel="icon" type="image/png" href="favicon.png">
    
    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        /* MTM Brand Colors */
        :root {
            --mtm-primary: #1ab1d2;
            --mtm-accent: #f18f38;
            --mtm-navy: #1c487b;
            --mtm-soft-blue: #85abbd;
            --mtm-cream: #fef4e3;
            --mtm-white: #fafdfe;
            --mtm-success: #059669;
            --mtm-warning: #d97706;
            --mtm-error: #dc2626;
            --mtm-text: #333333;
            --mtm-text-secondary: #666666;
            --mtm-border: #e5e5e5;
            --mtm-shadow: 0 2px 4px rgba(0,0,0,0.08);
            --mtm-shadow-hover: 0 4px 8px rgba(0,0,0,0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--mtm-cream);
            line-height: 1.6;
            color: var(--mtm-text);
            font-size: 16px;
        }

        /* Icon styles */
        .icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            stroke: var(--mtm-accent);
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            vertical-align: middle;
            margin-right: 8px;
        }

        .icon-large {
            width: 32px;
            height: 32px;
            margin-right: 12px;
            stroke: var(--mtm-accent);
        }

        .icon-white {
            stroke: white !important;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header with MTM branding */
        .header-wrapper {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .header-border-top {
            height: 4px;
            background: var(--mtm-primary);
        }
        
        .header {
            padding: 32px 48px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .header-content {
            flex: 1;
        }

        .header h1 {
            font-size: 42px;
            color: var(--mtm-navy);
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 18px;
            color: var(--mtm-text-secondary);
            font-weight: 400;
        }

        .header-logo {
            height: 65px;
            margin-left: 32px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .header-border-bottom {
            height: 2px;
            background: var(--mtm-primary);
        }

        .compas-info {
            background: var(--mtm-white);
            padding: 24px 48px;
            border-bottom: 1px solid var(--mtm-border);
        }
        
        .compas-content {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        
        .compas-description {
            color: var(--mtm-text);
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 12px;
        }
        
        .compas-description strong {
            color: var(--mtm-navy);
            font-weight: 600;
        }
        
        .compas-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: var(--mtm-primary);
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.2s ease;
            padding: 8px 16px;
            border-radius: 6px;
            background: rgba(26, 177, 210, 0.05);
        }
        
        .compas-link:hover {
            background: rgba(26, 177, 210, 0.1);
            transform: translateX(2px);
        }
        
        .compas-link svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            transition: transform 0.2s ease;
        }
        
        .compas-link:hover svg {
            transform: translateX(3px);
        }
        
        .method-highlight {
            display: inline-block;
            background: var(--mtm-accent);
            color: white;
            padding: 6px 14px;
            border-radius: 4px;
            font-weight: 700;
            margin: 0 4px;
            text-transform: uppercase;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .main-content {
            background: white;
            border-radius: 8px;
            padding: 48px;
            box-shadow: var(--mtm-shadow);
            min-height: 500px;
        }

        .progress-bar {
            height: 8px;
            background: var(--mtm-border);
            border-radius: 4px;
            margin-bottom: 32px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--mtm-primary);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .level {
            display: none;
        }

        .level.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: var(--mtm-navy);
            margin-bottom: 16px;
            font-size: 32px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        h3 {
            color: var(--mtm-primary);
            margin-bottom: 16px;
            font-size: 24px;
            font-weight: 500;
        }

        .intro-text {
            color: var(--mtm-text-secondary);
            margin-bottom: 32px;
            font-size: 18px;
            line-height: 1.6;
        }

        .info-box {
            background: var(--mtm-white);
            padding: 24px;
            border-radius: 8px;
            margin: 24px 0;
            border: 1px solid var(--mtm-border);
        }

        .info-box h3 {
            color: var(--mtm-navy);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
        }

        .info-box ul {
            color: var(--mtm-text-secondary);
            line-height: 2;
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            padding-left: 32px;
            position: relative;
            margin-bottom: 8px;
        }

        .info-box li::before {
            content: "✓";
            position: absolute;
            left: 8px;
            color: var(--mtm-primary);
            font-weight: bold;
        }

        .approach-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 32px 0;
        }

        .approach-card {
            background: white;
            border: 2px solid var(--mtm-border);
            border-radius: 8px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .approach-card.default::after {
            content: 'Recommended';
            position: absolute;
            top: 12px;
            right: 12px;
            background: var(--mtm-success);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .approach-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--mtm-shadow-hover);
            border-color: var(--mtm-primary);
        }

        .approach-card.selected {
            background: var(--mtm-primary);
            color: white;
            border-color: var(--mtm-primary);
        }

        .approach-card.selected .category,
        .approach-card.selected p {
            color: white;
            opacity: 0.95;
        }

        .approach-card h4 {
            margin-bottom: 8px;
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .approach-card .category {
            font-size: 14px;
            color: var(--mtm-text-secondary);
            margin-bottom: 12px;
            font-weight: 500;
        }

        /* Tools Section */
        .tools-section {
            margin: 32px 0;
        }

        .tool-input-group {
            background: var(--mtm-white);
            border: 1px solid var(--mtm-border);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
        }

        .tool-input-group h4 {
            color: var(--mtm-navy);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
        }

        .tool-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
            min-height: 44px;
            padding: 12px;
            background: white;
            border: 1px dashed var(--mtm-border);
            border-radius: 4px;
        }

        .tool-chip {
            background: var(--mtm-primary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .tool-chip .remove {
            cursor: pointer;
            font-weight: bold;
            opacity: 0.8;
        }

        .tool-chip .remove:hover {
            opacity: 1;
        }

        /* Implementation Steps */
        .steps-container {
            margin: 32px 0;
        }

        .step-item {
            background: white;
            border: 1px solid var(--mtm-border);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 16px;
            box-shadow: var(--mtm-shadow);
        }

        .step-item-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .step-number {
            background: var(--mtm-primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .step-remove {
            margin-left: auto;
            color: var(--mtm-error);
            cursor: pointer;
            padding: 6px 12px;
            border: 1px solid var(--mtm-error);
            border-radius: 4px;
            font-size: 14px;
            background: white;
            transition: all 0.2s ease;
        }

        .step-remove:hover {
            background: var(--mtm-error);
            color: white;
        }

        .step-content {
            margin-left: 48px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--mtm-text);
            font-size: 14px;
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--mtm-border);
            border-radius: 4px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.2s ease;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--mtm-primary);
            box-shadow: 0 0 0 3px rgba(26, 177, 210, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .add-button {
            background: white;
            color: var(--mtm-primary);
            border: 2px dashed var(--mtm-primary);
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .add-button:hover {
            background: var(--mtm-primary);
            color: white;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--mtm-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--mtm-navy);
        }

        .btn-secondary {
            background: var(--mtm-soft-blue);
            color: white;
        }

        .btn-secondary:hover {
            background: var(--mtm-navy);
        }

        .btn-success {
            background: var(--mtm-success);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid var(--mtm-border);
        }

        .summary-section {
            background: var(--mtm-white);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            border: 1px solid var(--mtm-border);
        }

        .summary-section h3 {
            margin-bottom: 16px;
            display: flex;
            align-items: center;
        }

        .summary-item {
            margin-bottom: 12px;
            padding-left: 24px;
            color: var(--mtm-text-secondary);
            line-height: 1.6;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 20px;
            border-radius: 8px;
            color: white;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 400px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--mtm-success);
        }

        .notification.error {
            background: var(--mtm-error);
        }

        .notification.info {
            background: var(--mtm-primary);
        }

        .help-text {
            color: var(--mtm-text-secondary);
            font-size: 14px;
            margin-top: 4px;
            font-style: italic;
        }

        /* Footer */
        .footer {
            background-color: var(--mtm-cream);
            text-align: center;
            padding: 24px;
            margin-top: 48px;
        }

        .footer img {
            height: 40px;
            margin-bottom: 12px;
        }

        .footer p {
            color: var(--mtm-text-secondary);
            font-size: 14px;
            margin: 0;
        }

        .footer a {
            color: var(--mtm-primary);
            text-decoration: none;
            font-weight: 500;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                padding: 24px;
            }
            
            .header-logo {
                margin: 20px 0 0 0;
            }
            
            .compas-info {
                padding: 20px 24px;
            }
            
            .compas-description {
                font-size: 14px;
            }
            
            .header h1 {
                font-size: 32px;
            }
            
            .approach-grid {
                grid-template-columns: 1fr;
            }
            
            .step-content {
                margin-left: 0;
                margin-top: 16px;
            }
            
            .main-content {
                padding: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-wrapper">
            <div class="header-border-top"></div>
            <div class="header">
                <div class="header-content">
                    <h1>COMPAS Method Planner</h1>
                    <p>Building Your Implementation Plan</p>
                </div>
                <img src="mtm-logo-trans.png" alt="Meet the Moment" class="header-logo">
            </div>
            <div class="compas-info">
                <div class="compas-content">
                    <p class="compas-description">
                        <strong>COMPAS</strong> is a human-centered framework for AI implementation that guides you through six key phases:
                        Context, Objective, <span class="method-highlight">Method</span>, Performance, Assessment, and Super You.
                        This planner focuses on the Method phase — creating concrete steps for HOW you'll implement AI solutions.
                    </p>
                    <a href="https://www.linkedin.com/pulse/stop-fixing-flamethrowers-human-guide-navigating-shewe" target="_blank" class="compas-link">
                        Learn more about the COMPAS framework
                        <svg viewBox="0 0 24 24" fill="none">
                            <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </a>
                </div>
            </div>
            <div class="header-border-bottom"></div>
        </div>

        <div class="main-content">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>

            <!-- Level 0: Overview -->
            <div class="level active" id="level-0">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                    </svg>
                    Welcome to Method Planning
                </h2>
                <p class="intro-text">
                    In the previous sessions, you identified your Context (pain points) and Objectives (what to solve).
                    Now it's time to define HOW you'll actually implement AI solutions - with concrete steps, not abstract strategy.
                </p>
                
                <div class="info-box">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M9 11H3m6 0V5m0 6l-6-6m15 6h6m-6 0V5m0 6l6-6M9 13v6m0 0H3m6 0l-6 6m15-6v6m0 0h6m-6 0l6 6"/>
                        </svg>
                        Your Method Plan Will Answer:
                    </h3>
                    <ul>
                        <li>Which implementation approach will you take?</li>
                        <li>Which tools are you already using or planning to use?</li>
                        <li>What are your concrete implementation steps?</li>
                        <li>What safeguards are built in?</li>
                        <li>How will you know it's working?</li>
                    </ul>
                </div>

                <p style="margin-top: 32px; color: var(--mtm-text-secondary);">
                    This planner will guide you through each decision, helping you build a complete Method Plan 
                    that you can export as a PDF for your team and stakeholders.
                </p>
            </div>

            <!-- Level 1: Choose Approach -->
            <div class="level" id="level-1">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M9 20h6M12 4v12m0 0l-3-3m3 3l3-3"/>
                        <circle cx="12" cy="20" r="1"/>
                    </svg>
                    Choose Your Implementation Approach
                </h2>
                <p class="intro-text">Start with your risk tolerance and organizational readiness. We recommend starting with a small pilot program.</p>
                
                <div class="approach-grid">
                    <div class="approach-card default selected" onclick="selectApproach('pilot', this)" id="pilot-card">
                        <h4>
                            <svg class="icon" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="3"/>
                                <path d="M12 1v6m0 6v6m0 6M4.22 4.22l4.24 4.24m7.08 7.08l4.24 4.24M1 12h6m6 0h6m6 0M4.22 19.78l4.24-4.24m7.08-7.08l4.24-4.24"/>
                            </svg>
                            Small Pilot Program
                        </h4>
                        <div class="category">Low Risk - Recommended Start</div>
                        <p>Test with 2-3 willing participants. Quick feedback, easy to adjust.</p>
                    </div>
                    
                    <div class="approach-card" onclick="selectApproach('department', this)">
                        <h4>
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87m-4-12a4 4 0 0 1 0 7.75"/>
                            </svg>
                            Department Rollout
                        </h4>
                        <div class="category">Medium Risk</div>
                        <p>Implement within a single team. Requires buy-in and training.</p>
                    </div>
                    
                    <div class="approach-card" onclick="selectApproach('organization', this)">
                        <h4>
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M3 21h18M3 10h18M3 7l9-4 9 4M6 10v11m6-11v11m6-11v11"/>
                            </svg>
                            Organization-Wide
                        </h4>
                        <div class="category">Higher Impact</div>
                        <p>Full organizational implementation. Significant change management needed.</p>
                    </div>
                </div>
            </div>

            <!-- Level 2: Tools Section -->
            <div class="level" id="level-2">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                    </svg>
                    Identify Your AI Tools
                </h2>
                <p class="intro-text">We encourage you to use tools your organization already has. List the tools you'll be using for this implementation.</p>
                
                <div class="tools-section">
                    <div class="tool-input-group">
                        <h4>
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M9 11l3 3L22 4"/>
                                <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
                            </svg>
                            Tools Your Organization Currently Uses
                        </h4>
                        <p class="help-text">Add the AI tools your organization already has access to (e.g., ChatGPT, Microsoft Copilot, Claude)</p>
                        <input type="text" id="existingToolInput" placeholder="Enter tool name and press Enter" onkeypress="handleToolInput(event, 'existing')">
                        <div class="tool-chips" id="existingTools"></div>
                    </div>
                    
                    <div class="tool-input-group">
                        <h4>
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            Additional Tools You Plan to Explore (Optional)
                        </h4>
                        <p class="help-text">List any new tools you're considering for this implementation</p>
                        <input type="text" id="newToolInput" placeholder="Enter tool name and press Enter" onkeypress="handleToolInput(event, 'new')">
                        <div class="tool-chips" id="newTools"></div>
                    </div>
                </div>
            </div>

            <!-- Level 3: Implementation Steps -->
            <div class="level" id="level-3">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    Define Your Implementation Steps
                </h2>
                <p class="intro-text">Break down your implementation into concrete, actionable steps. Add as many as you need.</p>
                
                <div class="steps-container" id="stepsContainer">
                    <!-- Steps will be added here dynamically -->
                </div>
                
                <button class="add-button" onclick="addStep()">
                    <svg class="icon" viewBox="0 0 24 24" style="margin: 0;">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Implementation Step
                </button>
            </div>

            <!-- Level 4: Risk Assessment -->
            <div class="level" id="level-4">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                    </svg>
                    Risk Mitigation Planning
                </h2>
                <p class="intro-text">What could go wrong, and how will you address it? Planning for challenges helps ensure success.</p>
                
                <div class="info-box">
                    <h3>
                        <svg class="icon" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="12" y1="8" x2="12" y2="12"/>
                            <line x1="12" y1="16" x2="12.01" y2="16"/>
                        </svg>
                        Consider These Questions:
                    </h3>
                    <ul style="list-style: none; padding-left: 0;">
                        <li style="padding-left: 28px; position: relative;">
                            <span style="position: absolute; left: 0; color: var(--mtm-primary);">•</span>
                            What unexpected challenges might arise during implementation?
                        </li>
                        <li style="padding-left: 28px; position: relative;">
                            <span style="position: absolute; left: 0; color: var(--mtm-primary);">•</span>
                            How might different stakeholders react to these changes?
                        </li>
                        <li style="padding-left: 28px; position: relative;">
                            <span style="position: absolute; left: 0; color: var(--mtm-primary);">•</span>
                            What happens if the AI tool doesn't work as expected?
                        </li>
                        <li style="padding-left: 28px; position: relative;">
                            <span style="position: absolute; left: 0; color: var(--mtm-primary);">•</span>
                            Are there any ethical considerations to address?
                        </li>
                        <li style="padding-left: 28px; position: relative;">
                            <span style="position: absolute; left: 0; color: var(--mtm-primary);">•</span>
                            What's your backup plan if something goes wrong?
                        </li>
                    </ul>
                </div>
                
                <div class="risk-section">
                    <div class="form-group">
                        <label style="font-size: 16px; color: var(--mtm-navy); font-weight: 600;">Potential Risks & Challenges</label>
                        <p class="help-text">What concerns do you have about this implementation?</p>
                        <textarea id="risk-challenges" placeholder="Describe any risks or challenges you anticipate..." style="min-height: 120px;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label style="font-size: 16px; color: var(--mtm-navy); font-weight: 600;">Mitigation Strategies</label>
                        <p class="help-text">How will you address these risks?</p>
                        <textarea id="risk-mitigation" placeholder="Describe your strategies to prevent or handle these challenges..." style="min-height: 120px;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label style="font-size: 16px; color: var(--mtm-navy); font-weight: 600;">Responsible AI Considerations (Optional)</label>
                        <p class="help-text">Are there specific ethical, privacy, or fairness considerations for your use case?</p>
                        <textarea id="risk-responsible" placeholder="Note any responsible AI considerations relevant to your implementation..." style="min-height: 100px;"></textarea>
                    </div>
                </div>
            </div>

            <!-- Level 5: Success Metrics -->
            <div class="level" id="level-5">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M3 3v18h18"/>
                        <path d="M18 9l-5 5-3-3-5 5"/>
                    </svg>
                    Define Success Metrics
                </h2>
                <p class="intro-text">How will you know it's working?</p>
                
                <div class="metrics-list" id="metricsContainer">
                    <div class="metric-card" style="background: var(--mtm-white); border: 1px solid var(--mtm-border); border-radius: 8px; padding: 24px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label>Metric Name</label>
                            <input type="text" id="metric1-name" placeholder="e.g., Time Saved">
                        </div>
                        <div class="form-group">
                            <label>Current Baseline</label>
                            <input type="text" id="metric1-baseline" placeholder="e.g., 20 hours/week on reports">
                        </div>
                        <div class="form-group">
                            <label>Target</label>
                            <input type="text" id="metric1-target" placeholder="e.g., Reduce by 50%">
                        </div>
                        <div class="form-group">
                            <label>How to Measure</label>
                            <input type="text" id="metric1-measurement" placeholder="e.g., Time tracking">
                        </div>
                    </div>
                </div>
                
                <button class="add-button" onclick="addMetric()">
                    <svg class="icon" viewBox="0 0 24 24" style="margin: 0;">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add Another Metric
                </button>
            </div>

            <!-- Level 6: Summary -->
            <div class="level" id="level-6">
                <h2>
                    <svg class="icon icon-large" viewBox="0 0 24 24">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    Your Method Plan Summary
                </h2>
                <p class="intro-text">Review your complete implementation plan.</p>
                
                <div id="summaryContent">
                    <!-- Summary will be generated here -->
                </div>
                
                <div style="margin-top: 32px; text-align: center;">
                    <button class="btn btn-success" onclick="exportPDF()" style="font-size: 18px; padding: 16px 32px;">
                        <svg class="icon icon-white" viewBox="0 0 24 24" style="margin: 0;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="white"/>
                            <polyline points="14 2 14 8 20 8" stroke="white"/>
                            <line x1="16" y1="13" x2="8" y2="13" stroke="white"/>
                            <line x1="16" y1="17" x2="8" y2="17" stroke="white"/>
                            <polyline points="10 9 9 9 8 9" stroke="white"/>
                        </svg>
                        Export Method Plan as PDF
                    </button>
                </div>
            </div>

            <!-- Navigation -->
            <div class="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousLevel()">
                    <svg class="icon icon-white" viewBox="0 0 24 24" style="margin: 0;">
                        <line x1="19" y1="12" x2="5" y2="12" stroke="white"/>
                        <polyline points="12 19 5 12 12 5" stroke="white"/>
                    </svg>
                    Previous
                </button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextLevel()">
                    Next Step
                    <svg class="icon icon-white" viewBox="0 0 24 24" style="margin: 0;">
                        <line x1="5" y1="12" x2="19" y2="12" stroke="white"/>
                        <polyline points="12 5 19 12 12 19" stroke="white"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <img src="mtm-logo-trans.png" alt="Meet the Moment">
            <p>Made with ❤️ for Nonprofits by <a href="https://www.mtm.now" target="_blank">Meet the Moment</a></p>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Application state
        let state = {
            currentLevel: 0,
            approach: 'pilot', // Default to pilot
            existingTools: [],
            newTools: [],
            steps: [],
            risks: {
                challenges: '',
                mitigation: '',
                responsible: ''
            },
            metrics: []
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateNavigation();
            // Pre-select pilot as default
            state.approach = 'pilot';
        });

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Navigation
        function nextLevel() {
            if (!validateCurrentLevel()) return;
            
            saveCurrentLevel();
            state.currentLevel++;
            showLevel(state.currentLevel);
            updateNavigation();
            updateProgress();
        }

        function previousLevel() {
            if (state.currentLevel > 0) {
                state.currentLevel--;
                showLevel(state.currentLevel);
                updateNavigation();
                updateProgress();
            }
        }

        function showLevel(level) {
            document.querySelectorAll('.level').forEach(l => l.classList.remove('active'));
            document.getElementById(`level-${level}`).classList.add('active');
            
            // Generate summary when reaching last level
            if (level === 6) {
                generateSummary();
            }
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = state.currentLevel === 0 ? 'none' : 'block';
            nextBtn.style.display = state.currentLevel === 6 ? 'none' : 'block';
            
            if (state.currentLevel === 5) {
                nextBtn.innerHTML = 'Review Plan <svg class="icon icon-white" viewBox="0 0 24 24" style="margin: 0;"><line x1="5" y1="12" x2="19" y2="12" stroke="white"/><polyline points="12 5 19 12 12 19" stroke="white"/></svg>';
            } else {
                nextBtn.innerHTML = 'Next Step <svg class="icon icon-white" viewBox="0 0 24 24" style="margin: 0;"><line x1="5" y1="12" x2="19" y2="12" stroke="white"/><polyline points="12 5 19 12 12 19" stroke="white"/></svg>';
            }
        }

        function updateProgress() {
            const progress = (state.currentLevel / 6) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        // Validation - More flexible
        function validateCurrentLevel() {
            switch(state.currentLevel) {
                case 1:
                    // Approach is always selected (default is pilot)
                    break;
                case 2:
                    if (state.existingTools.length === 0 && state.newTools.length === 0) {
                        showNotification('Please add at least one tool you plan to use', 'error');
                        return false;
                    }
                    break;
                case 3:
                    // Check if there are any steps with content
                    const stepElements = document.querySelectorAll('.step-item');
                    if (stepElements.length > 0) {
                        // If steps exist, check if at least one has a description
                        let hasContent = false;
                        stepElements.forEach(item => {
                            const descInput = item.querySelector('.step-description');
                            if (descInput && descInput.value && descInput.value.trim()) {
                                hasContent = true;
                            }
                        });
                        // If there are steps but none have content yet, just show a gentle reminder
                        if (!hasContent) {
                            const proceed = confirm('Your implementation steps appear to be empty. Would you like to continue anyway?');
                            if (!proceed) return false;
                        }
                    }
                    // Allow proceeding even with no steps - they may add them later
                    break;
                case 4:
                    // Make risk assessment optional but strongly encouraged
                    const hasRiskPlanning = document.getElementById('risk-challenges').value || 
                                           document.getElementById('risk-mitigation').value;
                    if (!hasRiskPlanning) {
                        const message = 'Planning for potential challenges can significantly improve your implementation success.\n\n' +
                                      'Even a simple backup plan can make a big difference when unexpected issues arise.\n\n' +
                                      'Would you like to continue without risk mitigation planning?';
                        const proceed = confirm(message);
                        if (!proceed) return false;
                    }
                    break;
                case 5:
                    if (!document.getElementById('metric1-name').value || !document.getElementById('metric1-target').value) {
                        showNotification('Please define at least one success metric', 'error');
                        return false;
                    }
                    break;
            }
            return true;
        }

        // Save current level data
        function saveCurrentLevel() {
            switch(state.currentLevel) {
                case 3:
                    // Save steps
                    state.steps = [];
                    document.querySelectorAll('.step-item').forEach((item) => {
                        const desc = item.querySelector('.step-description')?.value || '';
                        const timeline = item.querySelector('.step-timeline')?.value || '';
                        const responsible = item.querySelector('.step-responsible')?.value || '';
                        if (desc.trim()) {
                            state.steps.push({ description: desc, timeline, responsible });
                        }
                    });
                    break;
                case 4:
                    // Save risks
                    state.risks.challenges = document.getElementById('risk-challenges').value;
                    state.risks.mitigation = document.getElementById('risk-mitigation').value;
                    state.risks.responsible = document.getElementById('risk-responsible').value;
                    break;
                case 5:
                    // Save metrics
                    state.metrics = [];
                    document.querySelectorAll('.metric-card').forEach(card => {
                        const name = card.querySelector('input[id$="-name"]').value;
                        const baseline = card.querySelector('input[id$="-baseline"]').value;
                        const target = card.querySelector('input[id$="-target"]').value;
                        const measurement = card.querySelector('input[id$="-measurement"]').value;
                        if (name && target) {
                            state.metrics.push({ name, baseline, target, measurement });
                        }
                    });
                    break;
            }
        }

        // Approach selection
        function selectApproach(approach, element) {
            state.approach = approach;
            document.querySelectorAll('.approach-card').forEach(card => {
                card.classList.remove('selected');
            });
            element.classList.add('selected');
            showNotification('Approach selected: ' + element.querySelector('h4').textContent.trim(), 'success');
        }

        // Tool handling
        function handleToolInput(event, type) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const input = event.target;
                const value = input.value.trim();
                
                if (value) {
                    if (type === 'existing') {
                        if (!state.existingTools.includes(value)) {
                            state.existingTools.push(value);
                            updateToolChips('existingTools', state.existingTools);
                        }
                    } else {
                        if (!state.newTools.includes(value)) {
                            state.newTools.push(value);
                            updateToolChips('newTools', state.newTools);
                        }
                    }
                    input.value = '';
                }
            }
        }

        function updateToolChips(containerId, tools) {
            const container = document.getElementById(containerId);
            container.innerHTML = tools.map(tool => `
                <div class="tool-chip">
                    ${tool}
                    <span class="remove" onclick="removeTool('${containerId}', '${tool}')">×</span>
                </div>
            `).join('');
        }

        function removeTool(containerId, tool) {
            if (containerId === 'existingTools') {
                state.existingTools = state.existingTools.filter(t => t !== tool);
                updateToolChips('existingTools', state.existingTools);
            } else {
                state.newTools = state.newTools.filter(t => t !== tool);
                updateToolChips('newTools', state.newTools);
            }
        }

        // Implementation steps
        let stepCount = 0;
        function addStep() {
            stepCount++;
            const container = document.getElementById('stepsContainer');
            const stepItem = document.createElement('div');
            stepItem.className = 'step-item';
            stepItem.innerHTML = `
                <div class="step-item-header">
                    <div class="step-number">${document.querySelectorAll('.step-item').length + 1}</div>
                    <input type="text" class="step-description" placeholder="What specific action will be taken?" style="flex: 1;">
                    <button class="step-remove" onclick="removeStep(this)">Remove</button>
                </div>
                <div class="step-content">
                    <div class="form-group">
                        <label>Timeline</label>
                        <input type="text" class="step-timeline" placeholder="e.g., 1 week, 2 days">
                    </div>
                    <div class="form-group">
                        <label>Person Responsible</label>
                        <input type="text" class="step-responsible" placeholder="Who will lead this step?">
                    </div>
                </div>
            `;
            container.appendChild(stepItem);
        }

        function removeStep(button) {
            button.closest('.step-item').remove();
            // Renumber steps
            document.querySelectorAll('.step-number').forEach((num, i) => {
                num.textContent = i + 1;
            });
        }

        // Metrics
        let metricCount = 1;
        function addMetric() {
            metricCount++;
            const container = document.getElementById('metricsContainer');
            const metricCard = document.createElement('div');
            metricCard.className = 'metric-card';
            metricCard.style = 'background: var(--mtm-white); border: 1px solid var(--mtm-border); border-radius: 8px; padding: 24px; margin-bottom: 20px;';
            metricCard.innerHTML = `
                <div class="form-group">
                    <label>Metric Name</label>
                    <input type="text" id="metric${metricCount}-name" placeholder="e.g., User Satisfaction">
                </div>
                <div class="form-group">
                    <label>Current Baseline</label>
                    <input type="text" id="metric${metricCount}-baseline" placeholder="e.g., 3.5/5 rating">
                </div>
                <div class="form-group">
                    <label>Target</label>
                    <input type="text" id="metric${metricCount}-target" placeholder="e.g., 4.5/5 rating">
                </div>
                <div class="form-group">
                    <label>How to Measure</label>
                    <input type="text" id="metric${metricCount}-measurement" placeholder="e.g., Monthly survey">
                </div>
            `;
            container.appendChild(metricCard);
        }

        // Generate summary
        function generateSummary() {
            const approachNames = {
                pilot: 'Small Pilot Program',
                department: 'Department Rollout',
                organization: 'Organization-Wide'
            };
            
            const checkIcon = '<svg class="icon" viewBox="0 0 24 24" style="width: 16px; height: 16px; stroke: var(--mtm-accent);"><path d="M20 6L9 17l-5-5"/></svg>';
            
            let summaryHTML = `
                <div class="summary-section">
                    <h3>${checkIcon} Implementation Approach</h3>
                    <div class="summary-item">${approachNames[state.approach] || 'Not selected'}</div>
                </div>
                
                <div class="summary-section">
                    <h3>${checkIcon} AI Tools</h3>
                    ${state.existingTools.length > 0 ? `
                        <div class="summary-item"><strong>Existing Tools:</strong> ${state.existingTools.join(', ')}</div>
                    ` : ''}
                    ${state.newTools.length > 0 ? `
                        <div class="summary-item"><strong>New Tools to Explore:</strong> ${state.newTools.join(', ')}</div>
                    ` : ''}
                </div>
                
                <div class="summary-section">
                    <h3>${checkIcon} Implementation Steps</h3>
                    ${state.steps.map((step, i) => `
                        <div class="summary-item">
                            <strong>Step ${i + 1}:</strong> ${step.description}<br>
                            ${step.timeline ? `Timeline: ${step.timeline}` : ''} 
                            ${step.responsible ? `| Responsible: ${step.responsible}` : ''}
                        </div>
                    `).join('')}
                </div>
                
                ${(state.risks.challenges || state.risks.mitigation || state.risks.responsible) ? `
                <div class="summary-section">
                    <h3>${checkIcon} Risk Mitigation Planning</h3>
                    ${state.risks.challenges ? `<div class="summary-item"><strong>Potential Risks:</strong> ${state.risks.challenges}</div>` : ''}
                    ${state.risks.mitigation ? `<div class="summary-item"><strong>Mitigation Strategies:</strong> ${state.risks.mitigation}</div>` : ''}
                    ${state.risks.responsible ? `<div class="summary-item"><strong>Responsible AI Considerations:</strong> ${state.risks.responsible}</div>` : ''}
                </div>
                ` : ''}
                
                <div class="summary-section">
                    <h3>${checkIcon} Success Metrics</h3>
                    ${state.metrics.map(metric => `
                        <div class="summary-item">
                            <strong>${metric.name}:</strong> ${metric.target}<br>
                            ${metric.baseline ? `Baseline: ${metric.baseline}` : ''} 
                            ${metric.measurement ? `| Measurement: ${metric.measurement}` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('summaryContent').innerHTML = summaryHTML;
        }

        // Export to PDF
        function exportPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const approachNames = {
                pilot: 'Small Pilot Program',
                department: 'Department Rollout',
                organization: 'Organization-Wide'
            };
            
            // Header
            doc.setFontSize(20);
            doc.text('COMPAS Method Plan', 20, 20);
            doc.setFontSize(12);
            doc.text('Building Your Implementation Plan', 20, 30);
            doc.text(new Date().toLocaleDateString(), 20, 36);
            
            // Add MTM footer text
            doc.setFontSize(10);
            doc.text('Created with the COMPAS Method Planner by Meet the Moment', 20, 42);
            
            let yPos = 55;
            
            // Approach
            doc.setFontSize(14);
            doc.text('Implementation Approach', 20, yPos);
            yPos += 8;
            doc.setFontSize(11);
            doc.text(approachNames[state.approach] || 'Not specified', 25, yPos);
            yPos += 15;
            
            // Tools
            if (state.existingTools.length > 0 || state.newTools.length > 0) {
                doc.setFontSize(14);
                doc.text('AI Tools', 20, yPos);
                yPos += 8;
                doc.setFontSize(11);
                
                if (state.existingTools.length > 0) {
                    doc.text('Existing Tools:', 25, yPos);
                    yPos += 6;
                    state.existingTools.forEach(tool => {
                        doc.text(`• ${tool}`, 30, yPos);
                        yPos += 6;
                    });
                    yPos += 4;
                }
                
                if (state.newTools.length > 0) {
                    doc.text('New Tools to Explore:', 25, yPos);
                    yPos += 6;
                    state.newTools.forEach(tool => {
                        doc.text(`• ${tool}`, 30, yPos);
                        yPos += 6;
                    });
                }
                yPos += 10;
            }
            
            // Implementation Steps
            if (state.steps.length > 0) {
                doc.setFontSize(14);
                doc.text('Implementation Steps', 20, yPos);
                yPos += 8;
                doc.setFontSize(11);
                state.steps.forEach((step, i) => {
                    if (yPos > 270) {
                        doc.addPage();
                        yPos = 20;
                    }
                    const stepLines = doc.splitTextToSize(`${i + 1}. ${step.description}`, 165);
                    stepLines.forEach(line => {
                        doc.text(line, 25, yPos);
                        yPos += 6;
                    });
                    if (step.timeline || step.responsible) {
                        doc.text(`   ${step.timeline ? `Timeline: ${step.timeline}` : ''} ${step.responsible ? `| Responsible: ${step.responsible}` : ''}`, 25, yPos);
                        yPos += 10;
                    } else {
                        yPos += 4;
                    }
                });
            }
            
            // Risk Mitigation Planning
            if (state.risks.challenges || state.risks.mitigation || state.risks.responsible) {
                if (yPos > 240) {
                    doc.addPage();
                    yPos = 20;
                }
                doc.setFontSize(14);
                doc.text('Risk Mitigation Planning', 20, yPos);
                yPos += 8;
                doc.setFontSize(11);
                
                if (state.risks.challenges) {
                    doc.text('Potential Risks & Challenges:', 25, yPos);
                    yPos += 6;
                    const challengeLines = doc.splitTextToSize(state.risks.challenges, 160);
                    challengeLines.forEach(line => {
                        if (yPos > 270) {
                            doc.addPage();
                            yPos = 20;
                        }
                        doc.text(line, 30, yPos);
                        yPos += 6;
                    });
                    yPos += 6;
                }
                
                if (state.risks.mitigation) {
                    if (yPos > 260) {
                        doc.addPage();
                        yPos = 20;
                    }
                    doc.text('Mitigation Strategies:', 25, yPos);
                    yPos += 6;
                    const mitigationLines = doc.splitTextToSize(state.risks.mitigation, 160);
                    mitigationLines.forEach(line => {
                        if (yPos > 270) {
                            doc.addPage();
                            yPos = 20;
                        }
                        doc.text(line, 30, yPos);
                        yPos += 6;
                    });
                    yPos += 6;
                }
                
                if (state.risks.responsible) {
                    if (yPos > 260) {
                        doc.addPage();
                        yPos = 20;
                    }
                    doc.text('Responsible AI Considerations:', 25, yPos);
                    yPos += 6;
                    const responsibleLines = doc.splitTextToSize(state.risks.responsible, 160);
                    responsibleLines.forEach(line => {
                        if (yPos > 270) {
                            doc.addPage();
                            yPos = 20;
                        }
                        doc.text(line, 30, yPos);
                        yPos += 6;
                    });
                }
                yPos += 4;
            }
            
            // Success Metrics
            if (state.metrics.length > 0) {
                if (yPos > 240) {
                    doc.addPage();
                    yPos = 20;
                }
                doc.setFontSize(14);
                doc.text('Success Metrics', 20, yPos);
                yPos += 8;
                doc.setFontSize(11);
                state.metrics.forEach(metric => {
                    if (yPos > 270) {
                        doc.addPage();
                        yPos = 20;
                    }
                    doc.text(`• ${metric.name}: ${metric.target}`, 25, yPos);
                    yPos += 6;
                    if (metric.baseline || metric.measurement) {
                        doc.text(`  ${metric.baseline ? `Baseline: ${metric.baseline}` : ''} ${metric.measurement ? `| Measurement: ${metric.measurement}` : ''}`, 30, yPos);
                        yPos += 6;
                    }
                });
            }
            
            // Save PDF
            const filename = `COMPAS-Method-Plan-${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(filename);
            
            showNotification('PDF exported successfully!', 'success');
        }
    </script>
</body>
</html>